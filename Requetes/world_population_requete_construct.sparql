PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX ex: <http://example.org/population/>
PREFIX schema: <http://schema.org/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

CONSTRUCT {
  ?country a ex:Country ;
           ex:rank ?rank ;
           ex:isoCode ?cca3 ;
           schema:name ?countryName ;
           schema:capital ?capital ;
           schema:continent ?continent ;
           ex:population2022 ?population2022 ;
           ex:population2020 ?population2020 ;
           ex:population2015 ?population2015 ;
           ex:population2010 ?population2010 ;
           ex:population2000 ?population2000 ;
           ex:population1990 ?population1990 ;
           ex:population1980 ?population1980 ;
           ex:population1970 ?population1970 ;
           ex:areaKm2 ?area ;
           ex:density ?density ;
           ex:growthRate ?growthRate ;
           ex:worldPercentage ?worldPercentage .
}
FROM <file:world_population.csv#delimiter=,>
WHERE {
  # Correspondance exacte avec les noms de colonnes convertis par Tarql
  BIND(IRI(CONCAT("http://example.org/country/", ENCODE_FOR_URI(?Country_Territory))) AS ?country)

  BIND(xsd:integer(?Rank) AS ?rank)
  BIND(xsd:string(?CCA3) AS ?cca3)
  BIND(xsd:string(?Country_Territory) AS ?countryName)
  BIND(xsd:string(?Capital) AS ?capital)
  BIND(xsd:string(?Continent) AS ?continent)

  BIND(xsd:integer(?_2022_Population) AS ?population2022)
  BIND(xsd:integer(?_2020_Population) AS ?population2020)
  BIND(xsd:integer(?_2015_Population) AS ?population2015)
  BIND(xsd:integer(?_2010_Population) AS ?population2010)
  BIND(xsd:integer(?_2000_Population) AS ?population2000)
  BIND(xsd:integer(?_1990_Population) AS ?population1990)
  BIND(xsd:integer(?_1980_Population) AS ?population1980)
  BIND(xsd:integer(?_1970_Population) AS ?population1970)

  BIND(xsd:decimal(?Area__km__) AS ?area)
  BIND(xsd:decimal(?Density__per_km__) AS ?density)
  BIND(xsd:decimal(?Growth_Rate) AS ?growthRate)
  BIND(xsd:decimal(?World_Population_Percentage) AS ?worldPercentage)
}
